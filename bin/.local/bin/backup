#!/bin/sh

set -x

# Only run on sunday
[ $(date "+%a") != "Sun" ] && exit 1

# Substract 1 because I consider Monday as first day of week while `date'
# considers Sunday as first day of week
week_num=$(($(date "+%U") - 1))

function do_stuff () {
    cd $1
    git add .
    git commit -m "Week $week_num"
    git push
    git archive -o "$HOME/Desktop/$(basename $1)-$week_num.tar.gz" HEAD
}

dirs=(
    $HOME/Documents/Chess
    $HOME/Documents/Journal
    $HOME/Documents/Zettelkasten
    $HOME/Documents/dev.log
)

for dir in ${dirs[@]}; do [ -d $dir ] && do_stuff $dir; done
