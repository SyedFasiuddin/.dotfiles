#! /bin/sh

if [[ -d "$HOME/Journal" ]] ; then
    year=`date "+%Y"`
    month=`date "+%m"`
    day=`date "+%d"`
    yr="$HOME/Journal/$year"

    if [[ -d "$yr" ]] ; then
        if [[ ! -d "$yr/$month" ]] ; then
            mkdir "$yr/$month"
        fi
    else
        mkdir "$yr" "$yr/$month"
    fi

    if [[ "$TERM_PROGRAM" = tmux ]] ; then
        tmux list-windows | grep note 1> /dev/null ||
            ( tmux neww -n note &&
            tmux send-keys -t :note "vi \"$yr/$month/$day.txt\"" C-m )
    else
        vi "$yr/$month/$day.txt"
    fi
else
    echo "Journal not found"
fi

